<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora con Callbacks</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">

                <h1 class="text-center mb-4">Calculadora con Callbacks</h1>

                <div class="card">
                    <div class="card-body">
                        <form id="formulario">
                            <div class="mb-3">
                                <label for="numero" class="form-label">Ingresa un número (1-25):</label>
                                <input type="number" class="form-control" id="numero" min="1" max="25"
                                    placeholder="Ejemplo: 10" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-100">Calcular Multiplicaciones</button>
                        </form>
                    </div>
                </div>

                <div id="resultado" class="mt-4"></div>

            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script>
    // Validación simple con callbacks
    function validarNumero(numero, onSuccess, onError) {
        setTimeout(() => {
            if (isNaN(numero) || numero < 1 || numero > 25) {
                onError("Por favor ingresa un número válido entre 1 y 25");
            } else {
                onSuccess(numero);
            }
        }, 100);
    }

    // Procesa una tabla de multiplicar completa
    function procesarTabla(numero, onProgreso, onCompleto) {
        let i = 1;
        const total = numero;

        function siguiente() {
            if (i <= total) {
                setTimeout(() => {
                    const texto = `${numero} × ${i} = ${numero * i}`;
                    onProgreso(texto, i, total);
                    i++;
                    siguiente(); // ← solo un ciclo controlado por callback
                }, 200);
            } else {
                onCompleto();
            }
        }

        siguiente();
    }

    // Funciones de interfaz
    function mostrarError(msg) {
        document.getElementById("resultado").innerHTML =
            `<div class="alert alert-danger">${msg}</div>`;
    }

    function mostrarResultado(txt) {
        document.getElementById("resultado").innerHTML +=
            `<div class="alert alert-light">${txt}</div>`;
    }

    function mostrarCompleto() {
        document.getElementById("resultado").innerHTML +=
            `<div class="alert alert-success">¡Cálculo completado!</div>`;
    }

    // Manejo del formulario
    document.getElementById("formulario").addEventListener("submit", (e) => {
        e.preventDefault();

        const numero = parseInt(document.getElementById("numero").value);
        const boton = document.querySelector("button");

        boton.disabled = true;
        document.getElementById("resultado").innerHTML = "";

        validarNumero(numero,
            (n) => {
                procesarTabla(n,
                    (texto) => mostrarResultado(texto),
                    () => {
                        mostrarCompleto();
                        boton.disabled = false;
                    }
                );
            },
            (err) => {
                mostrarError(err);
                boton.disabled = false;
            }
        );
    });
</script>
</body>


</html>
